---
title: 写的贪吃蛇
tags: javascript
---
## 前两天在论坛上看到有人写了贪吃蛇，联机对战，自己也想学着写一个贪吃蛇，发布到网站上。先从单机版的贪吃蛇写起~

首先介绍一下整体的思路，整个地图是一个canvas元素，这个canvas就相当于是画布。在画布上画蛇就是在canvas内的规定好的位置画矩形，边写边想，想到哪里写到哪里。


### 代码实现
---
#### canvas介绍
首先get到页面中的canvas元素，`var canvas = documents.getElementById('canvas')`,此时canvas在js中就相当于是画布，然后再得到画笔，`var content = canvas.getContext('2d')`，之后再操作`content`的方法，就可以得到相应的图形。这里就用到了rect方法，画矩形。

---
#### 蛇的思路
在这个代码中，学到了真正的面向对象的写代码方式。
创建一个数组，数组中放rect()对象。蛇头的那个rect对象在数组的第一位。
这里介绍一下蛇移动的思路吧。
1. 蛇每移动一次，就使用splice方法，在数组中第二个位置中插入一个和头部一模一样的rect
2. 然后判断是不是吃到了食物，如果吃到了食物，则生成新的食物，蛇头向当前的方向移动一个单位
3. 如果没有吃到食物，就把蛇尾的元素pop掉，然后蛇头向当前方向移动一个单位。
4. 以上是蛇的数组的操作方式，然后将蛇在画布中展示出来。使用canvas对象的draw方法，用一个for循环，将方块画出来。


#### 学到的一些小东西
---
在js中，有一个东西叫做定时器，和单片机里面的定时器几乎是同样的东西。相当于定一个时间间隔，每过多少时间，就执行一次函数里面的代码。
比如：
```
var timer = setInterval(function(){
	context.clearRect(0, 0, canvas.width, canvas.height);  //清除已经画的蛇
	food.draw();	//画出食物矩形
	snake.move();	//蛇身进行移动，相当于在脑海中想象蛇应该在的位置
	snake.draw();	//调用draw函数，把蛇的矩形画到画布上
},100)
```
---

在随机生成食物的时候，想要生成在【0-480】之内的，20倍数的随机数，可以先生成一个【0-24】内的随机整数，然后再给这个整数乘以20，就可以达到效果了。
---


判断蛇移动方向，需要设置按键监听事件。这个也是类似定时器一样，在后台自动就监听，感觉类似于外部中断。
具体代码如下：
```
document.onkeydown = function(e){
	var ev = e || window.event;   //防止事件冲突
	switch(ev.keyCode){		//判断按键的键值是什么
		case 37:	//按键为左
		    do()...;
		    break;
		case 38:	//上
		    do()...;
		    break;
		case 39:	//右
		    do()...;
		    break;
		case 40:	//下
		    do()...;	
		    break;
		default:
		    break;
	}
}

```

---

#### 最后
这次小项目只是一个单机版的贪吃蛇，锻炼了js的能力，学习到了js的很多基础知识，已经发布到github上了，还加了背景音乐，配了图，有机会可以去玩一玩。嘿嘿~~
https://lrqwriting.top/snakeGame



